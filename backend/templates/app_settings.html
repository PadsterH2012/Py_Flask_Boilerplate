{% extends "base.html" %}

{% block title %}App Settings{% endblock %}

{% block content %}
    <h1>App Settings</h1>
    <form id="appSettingsForm">
        <label for="theme">Theme:</label>
        <select id="theme" name="theme">
            <option value="light" {% if current_theme != 'dark' %}selected{% endif %}>Light</option>
            <option value="dark" {% if current_theme == 'dark' %}selected{% endif %}>Dark</option>
        </select>
        
        <button type="submit">Save Settings</button>
    </form>

    <script>
    document.getElementById('appSettingsForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const theme = document.getElementById('theme').value;
        
        fetch('/app_settings', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `theme=${theme}`
        })
        .then(response => response.json())
        .then(data => {
            if (data.message === 'Settings updated successfully!') {
                alert('Settings updated successfully!');
                location.reload();
            } else {
                console.error('Error:', data.message);
            }
        })
        .catch((error) => {
            console.error('Error:', error);
            alert('An error occurred while updating settings.');
        });
    });
    </script>
{% endblock %}
